íì§ˆí™˜ ì˜ì‹¬ ì‘ê¸‰í™˜ìì˜ ì§„ë‹¨ê³¼ì • ë‹¨ì¶•ì„ ìœ„í•œ AI í‰ë¶€ X-ray ì§„ë‹¨ ë³´ì¡° ì„œë¹„ìŠ¤
=============

## ì£¼ì œ êµ¬ì²´í™” ê³¼ì •
#### `1) ì˜ë£Œ í˜„ì¥ ë¦¬ì„œì¹˜`
- ì‘ê¸‰ì‹¤ì„ ì°¾ëŠ” í™˜ìì˜ ì ˆë°˜ ì´ìƒ(56%)ì´ ì—‘ìŠ¤ë ˆì´ ì´¬ì˜ì„ ë°›ê³  ìˆë‹¤. 
- ê·¸ ì¤‘ í‰ë¶€ì™¸ê³¼ëŠ” x-ray ì´¬ì˜ë¥ ì´ 90%ë¡œ ê°€ì¥ ë†’ì•˜ë‹¤. 
- í‰ë¶€ì†ìƒì€ ì™¸ìƒìœ¼ë¡œ ì¸í•œ ì‚¬ë§ì˜ 20~25%ë¥¼ ì°¨ì§€í•  ì •ë„ë¡œ ì ì •ì‹œê¸°ì˜ ì ì ˆí•œ ì¹˜ë£Œê°€ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤. 
- x-ray ì§„ë‹¨ì— ì†Œìš”ë˜ëŠ” ì‹œê°„ì€ 3371ì´ˆ, ì•½ 1ì‹œê°„ìœ¼ë¡œ ê³¨ë“ íƒ€ì„ì´ ì¤‘ìš”í•œ ì‘ê¸‰í™˜ìì—ê²ŒëŠ” ê¸´ ì‹œê°„ì¼ ê²ƒì´ë‹¤. 
- ì‘ê¸‰ì‹¤ì—ì„œì˜ ëŒ€ê¸°ì‹œê°„ì— ëŒ€í•œ ë§Œì¡±ë„ ì¡°ì‚¬ì— ì˜í•˜ë©´ 40ì ëŒ€ë¡œ ë‚®ë‹¤ëŠ” ê²ƒë„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.
- ì˜ìƒì˜í•™ê³¼ ì „ë¬¸ì˜ ì¸í„°ë·° ì§„í–‰
    - ìœ ë°©ì•” ì„íšŒ detection í•˜ëŠ” 'ìºë“œ' í™œë°œíˆ ì‚¬ìš©
    - ìœ ìš©í•˜ê³  ì •í™•í•œ í”„ë¡œê·¸ë¨ì´ë¼ë©´ ë³´ì¡°ê¸°êµ¬ë¡œì¨ ì‚¬ìš©í•  ì˜í–¥ ìˆìŒ
    - â€˜ë£¨ë‹›â€™, â€˜ë·°ë…¸â€™ ë“±ì˜ ì‹œì œí’ˆ ğŸ¡ª ë¹„ìš© ë¬¸ì œ ë°œìƒ

#### `2) ì˜ë£Œ í˜„ì¥ ë¬¸ì œì `
- ì§„ë‹¨ ì‹œê°„ì´ ë§ì´ ê±¸ë¦¬ëŠ” ì´ìœ ëŠ” x-ray ì´¬ì˜ì„ í•œ í›„ ê·¸ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì¶”ê°€ ê²€ì‚¬ ì—¬ë¶€ë¥¼ ê²°ì •í•˜ê²Œ ë˜ë©° ì´ í›„ ctë‚˜ mri ë“±ì˜ ì¶”ê°€ ê²€ì‚¬ë¥¼ ë§ˆì¹œ í›„ì— ìµœì¢…ì§„ë‹¨ì— ì´ë¥´ê²Œ ë˜ëŠ” 4ë‹¨ê³„ì˜ í”„ë¡œì„¸ìŠ¤ë¡œ ì§„í–‰ë˜ê¸° ë•Œë¬¸ì´ì—ˆë‹¤. 
- ê° í”„ë¡œì„¸ìŠ¤ë³„ ëŒ€ê¸°ì‹œê°„ê¹Œì§€ ê³ ë ¤í•œë‹¤ë©´ ë¶„ëª… ì ì§€ ì•Šì€ ì‹œê°„ì¼ ê²ƒì´ë‹¤.

#### `3) í”„ë¡œì íŠ¸ ëª©í‘œ`
- í•´ê²°ë°©ì•ˆ : ì‘ê¸‰í™˜ê²½ì˜ ì‹œê°„ê³¼ ë¹„ìš©ì˜ ì ˆê°ì„ ìœ„í•´ ì¶”ê°€ ê²€ì‚¬ë¥¼ ìƒëµí•œ, x-ray ì´¬ì˜ë§Œìœ¼ë¡œ ìµœì¢…ì§„ë‹¨ì— ì´ë¥´ëŠ” ë‹¨ì¶•ëœ ì§„ë‹¨ í”„ë¡œì„¸ìŠ¤ ê°œë°œ
<img src="./Result_Image/Process.png"  width="452" height="219"/>
- íƒ€ê²Ÿì‹œì¥ : ì‘ê¸‰ì‹¤, êµ¬ê¸‰ì°¨ ë³´ìœ  ë³‘ì›
- ê³ ê°ì˜ Needs : ì ì€ ë°ì´í„°ë¡œ ë¹ ë¥¸ ì‹œê°„ì— x-ray ì‚¬ì§„ì„ ì§„ë‹¨&ê´€ë¦¬í•  í”„ë¡œê·¸ë¨ í•„ìš”
- ê¸°ëŒ€ì‚¬í•­ : í™˜ìì˜ ìƒì¡´ìœ¨ì„ ë†’ì´ê³ , ì´ì— ì†Œìš”ë˜ëŠ” ì‹œê°„ê³¼ ë¹„ìš©ì„ ì¤„ì´ëŠ” ê²ƒ

ì§„ë‹¨ ì†ë„ 12ì´ˆë¡œ ì‘ê¸‰í™˜ìì˜ x-ray ì´ë¯¸ì§€ë¥¼ ì§„ë‹¨í•  ìˆ˜ ìˆëŠ” ì •í™•ë„ 97.1, auc 84.12ì˜ ì„œë¹„ìŠ¤ë¥¼ ì œì‘í–ˆë‹¤. ë‹¤ìŒì€ ì‹¤ì œ ì„œë¹„ìŠ¤ì˜ ì‹œì—° ìº¡ì²˜í™”ë©´ì´ë©° x-ray ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ë©´ ìƒìœ„ 3ê°œì˜ ì§ˆë³‘ì„ í™•ë¥ ê°’ê³¼ í•¨ê»˜ ë³´ì—¬ì¤€ë‹¤. ë¹¨ê°„ ë°•ìŠ¤ëŠ” ì§ˆë³‘ìœ¼ë¡œ ì˜ì‹¬ë˜ëŠ” ì˜ì—­ì„ í‘œì‹œí•´ ì¤€ë‹¤.


## Classification
#### `1) ê³ ë ¤í•œ ì `
- 13ê°œì˜ ì§ˆë³‘ì„ ë¶„ë¥˜í•  ìˆ˜ ìˆëŠ” ëª¨ë¸ ìƒì„±
- ê° ì§ˆë³‘ì— ëŒ€í•œ ì •í™•ë„ ì¶œë ¥
- ì§§ì€ ì‹œê°„ ì•ˆì— ë†’ì€ ì •í™•ë„ë¥¼ ë‚´ì•¼í•¨

#### `2) ë°ì´í„°`
- ìµœëŒ€í•œ ë§ì€ ì–‘ì˜ ë°ì´í„°ë¥¼ ìœ„í•´ ë©°ì¹ ê°„ ì„œì¹­
- ì‹ ë¢°ì„± ìˆê³  ì „ë¬¸ê°€ì— ì˜í•´ ë¼ë²¨ë§ì´ ë˜ì–´ ìˆëŠ” ì´ë¯¸ì§€ ë°ì´í„° ë°œê²¬
- ë°ì´í„° ìˆ˜ì§‘ : https://www.kaggle.com/nih-chest-xrays/data
- bounding box ê°€ ìˆëŠ” ë°ì´í„°ë¥¼ ë³´ê³  ì¶”í›„ Detectionë„ ê²°ì •

#### `2) ê¸°ìˆ  ì„ íƒ ê³¼ì •`
- ì´ˆê¸° : colab gpu í•™ìŠµ ì§„í–‰ (1epoch ë‹¹ ëª‡ì‹œê°„ì´ ê±¸ë¦´ ì •ë„ë¡œ ì˜¤ë˜ ê±¸ë¦¼/ì¤‘ê°„ì— êº¼ì§)
- ì´í›„ : Ubuntu ì„œë²„ ëŒ€ì—¬ -> í•œ ëª¨ë¸ ë‹¹ 2-3ì¼ì— í•™ìŠµ ê°€ëŠ¥

- tensorflowì—ì„œ ì œê³µí•˜ëŠ” 6ê°€ì§€ CNN model ì‹¤í—˜
<img src="https://user-images.githubusercontent.com/71118045/144366234-16d81ff2-3980-4499-96c6-4c4218b2dd28.PNG"  width="900" height="300"/>

- imagenetì˜ pre-trained weight í•™ìŠµ
- test AUCê°€ ê°€ì¥ ë†’ì•˜ë˜ efficientnet modelì„ fine-tuningí•˜ì—¬ ì‚¬ìš©

#### `3) ì •í™•ë„ë¥¼ ë†’ì´ê¸° ìœ„í•œ ì‹œë„`
- ë‹¤ì–‘í•œ ëª¨ë¸ ì‹œë„
- ê¸°ì¡´ì— ì •í•´ì ¸ìˆë˜ ë°ì´í„° ë¹„ìœ¨ ì¡°ì • : Train, Valid, Test ë°ì´í„° ë¹„ìœ¨ 0.64:0.16:0.2 -> 0.6:0.2:0.2
- Train, Test split í•¨ìˆ˜ì˜ stratify ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ì˜ ì§ˆë³‘ ë¶„í¬ ìœ ì§€ (MultilabelStratifiedKFold ì´ìš©)
- ê°™ì€ í™˜ìì˜ ë°ì´í„°ê°€Train, Valid, Test ë°ì´í„° ì— ëª¨ë‘ ë‚˜ëˆ„ì–´ ë“¤ì–´ê°€ ìˆì—ˆìŒ
    - ê°™ì€ í™˜ìì˜ ë°ì´í„°ë¼ë©´ í•˜ë‚˜ë§Œ ë‚¨ê¸°ê³  ì‚­ì œ
    - ëª¨ë“  ë°ì´í„°ì…‹ì— ë‹¤ë¥¸ í™˜ìê°€ ë“¤ì–´ê°€ë„ë¡ ì„¤ì •

## Detection
#### `1) ê³ ë ¤í•œ ì `
- 13ê°œì˜ ì§ˆë³‘ ìœ„ì¹˜ë¥¼ ê²€ì¶œí•  ìˆ˜ ìˆëŠ” ê°€ì¤‘ì¹˜ ê°’ ìƒì„±
- 



## ì›¹ì‚¬ì´íŠ¸ ê²°ê³¼
#### `1) ê³ ë ¤í•œ ì `
- í™˜ì ê´€ë¦¬ : í™˜ì ë“±ë¡ ë° ë¦¬ìŠ¤íŒ… ê°€ëŠ¥
- í™˜ì ì§„ë‹¨
    - ë¡œì»¬ì—ì„œ í™˜ì x-ray ì´ë¯¸ì§€ ì—…ë¡œë“œ
    - 12ì´ˆ ì§„ë‹¨
    - TOP3 ì§ˆë³‘ + ê° ì§ˆë³‘ì˜ í™•ë¥ ê°’ ì¶œë ¥
    - ì§ˆë³‘ ê°ì—¼ ì˜ì‹¬ ì˜ì—­ í‘œì‹œ
    - ì§„ë‹¨ íˆìŠ¤í† ë¦¬ ì—´ëŒ ë° ì‚­ì œ ê°€ëŠ¥

#### `2) ê¸°ìˆ  ì„ íƒ ê³¼ì •`
- ì–¸ì–´ ì„ íƒ
    - ë”¥ëŸ¬ë‹ ê¸°ìˆ  ì‚¬ìš© -> Tensorflow í•„ìš” -> Pythonì— ìµœìš°ì„ ìœ¼ë¡œ ë§ì¶° ê°œë°œë¨ -> __ë”¥ëŸ¬ë‹ ê°œë°œ : python ì–¸ì–´ ê²°ì •__
    - ë”¥ëŸ¬ë‹ ì½”ë“œì™€ì˜ ì—°ê²° í•„ìš” -> __ë°±ì—”ë“œ/í”„ë¡ íŠ¸ì—”ë“œ : python ì–¸ì–´ ê²°ì •__

- í”„ë ˆì„ì›Œí¬ ì„ íƒ
    - python ì–¸ì–´ë¥¼ ì‚¬ìš©í•  Flask or Django ê³ ë¯¼
    - Flask ë¡œ ê°œë°œ ì‹œë„ : https://saeyoun.tistory.com/2 
    - ë³´ì•ˆ, ì¸ì¦ ë“±ì˜ ê¸°ëŠ¥ ì§ì ‘ êµ¬í˜„ ë³µì¡í•¨ & Flaskë¥¼ ì´ìš©í•œ ë§ì€ ê¸°ëŠ¥ì´ êµ¬í˜„ëœ í”„ë¡œì íŠ¸ë¥¼ ì°¾ê¸° ì–´ë ¤ì›€
    - Djangoë¡œ Airbnb í´ë¡ ì½”ë”©ì´ ê°€ëŠ¥í•˜ë‹¤ëŠ” ê²ƒì„ ë°œê²¬ -> ë¡œê·¸ì¸/ì´ë¯¸ì§€ì—…ë¡œë“œ/ë¦¬ìŠ¤íŒ…/ìƒì„¸ì •ë³´ ê´€ë¦¬ ë“± í•„ìš”í•œ ê¸°ëŠ¥ ê²¹ì¹¨ -> í† ì´í”„ë¡œì íŠ¸ ì§„í–‰
    - __Djangoë¡œ ê°œë°œ ê²°ì •__ : https://saeyoun.tistory.com/3

#### `3) ê²°ê³¼`
<img src="https://user-images.githubusercontent.com/71118045/144365814-59484285-4c11-48ce-8e2a-cd99ccc134ad.PNG" width="600" height="300"/>


ìµœì¢… í”„ë¡œê·¸ë¨ êµ¬ì¡°
<img src="https://user-images.githubusercontent.com/71118045/144364448-1fdd71ac-c470-46ed-8b56-d014affe6594.PNG" width="500" height="300"/>


ì´ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ Classification and Detection ê¸°ë°˜ Web Serviceë¥¼ êµ¬í˜„í–ˆìœ¼ë©°, Classification ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ PGGANì„ ì‚¬ìš©í•˜ì—¬ í•©ì„± ì˜ë£Œ Xì„  ë°ì´í„°ë¥¼ ìƒì„±í–ˆë‹¤. ë¬¸ì œê°€ ìˆëŠ” ë¶€ìœ„ íŠ¹ì •, Xì„  ì²˜ë¦¬ì‹œê°„ ë‹¨ì¶•, ì‘ê¸‰í™˜ìì˜ ì •í™•í•œ ì§ˆë³‘ë¶„ë¥˜ ë“± ì˜ë£Œê³¼ì •ì˜ íš¨ìœ¨ì„± í–¥ìƒì— í™œìš©ë  ê²ƒìœ¼ë¡œ ê¸°ëŒ€ëœë‹¤.



## :sparkles:1. Classification



###### Weights: [Google Drive Link](https://drive.google.com/drive/folders/1-uo9GchtOoAFvXmE0zpPi0eaFgKNOrk6?usp=sharing)

## :sparkles:2. Detection

###### Training Data: [Google Drive Link](https://drive.google.com/drive/folders/11CUJGctnzHQcsq9O3WCSTRhgRjkMOOUN?usp=sharing)
###### Ultralytics Yolov5 : https://github.com/ultralytics/yolov5

<img src="./Result_Image/Detection_NIH_200.jpg"  width="400" height="400"/>




###### Result of NIH Data: [Google Drive Link](https://drive.google.com/drive/folders/1qo_5ICzeMUrHQ_-s0Z9d3KYSLCrNzqRl?usp=sharing)
###### Result of ChestX Data : [Google Drive Link](https://drive.google.com/drive/folders/1NBvWFz3Fto6ZqeLrqopEMlbUZnNpxodN?usp=sharing)
###### Result of NIH & ChestX Data: [Google Frive Link](https://drive.google.com/drive/folders/1Koryg3pxeUs7oJ0ulO7FEjrq0EMPB6of?usp=sharing)

## :sparkles:3. GAN Research

<img src="https://user-images.githubusercontent.com/85219925/144364517-22de0573-d468-433f-95d4-b4eaac10f902.png"  width="400" height="400"/>

###### Generated Image(PGGAN1): [Google Drive Link](https://drive.google.com/drive/folders/1qJj4dn9ap-fPbrHuP2OR9f7_tTKUm58L?usp=sharing)
###### Generated Image(PGGAN2): [Google Drive Link](https://drive.google.com/drive/folders/1IWavLvJQTNJ_Ui-s0R7is2MTI1Q3naOe?usp=sharing)
###### Generated Image(PGGAN3): [Google Drive Link](https://drive.google.com/drive/folders/1q1PmqqxZPPGEzazGkzOXv4WF1G5zFNO1?usp=sharing)
###### PGGAN Weights: [Google Drive Link](https://drive.google.com/drive/folders/1Y9l7wqjt-cKR-gJRIe8DqZwbG91nyXEy?usp=sharing)

###### Generated Image(DCGAN): [Google Drive Link](https://drive.google.com/drive/folders/18MekMJsuhZS6Shu3T6nvmNihK4M4oilz?usp=sharing)

## :book:Papers
###### 1. íì§ˆí™˜ ì˜ì‹¬ ì‘ê¸‰í™˜ìì˜ ì§„ë‹¨ ê³¼ì • ë‹¨ì¶•ì„ ìœ„í•œ AIê¸°ë°˜ X-rayì§„ë‹¨ ì‹œìŠ¤í…œ
###### https://drive.google.com/file/d/1FnQGBRWvJ70iH2Rut0L7hjO-4Bt15vpc/view?usp=sharing
###### 2. PGGAN synthetic dataë¥¼ í™œìš©í•œ Classê°„ ë°ì´í„°ë¶„í¬ì˜ ë¶ˆê· í˜• ì™„í™”ê°€ X-ray ì§ˆë³‘ ì§„ë‹¨ ì •í™•ë„ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ì—°êµ¬
###### https://drive.google.com/file/d/1OPLWdxKm7L0jW0QhTIYEo4-7AER3-JNz/view?usp=sharing

## :REFERENCE
###### https://www.koreascience.or.kr/article/JAKO201123736032447.pdf
